
<section class="resume-section" id="blog">
  <div class="resume-section-content">
   
    <h3 class="mt-4">Working with VCF Files Using <code>bcftools</code></h3>
    <p>VCF (Variant Call Format) files are a staple in bioinformatics for storing variant calls like SNPs, indels, and structural variants. One of the most powerful tools to manipulate, filter, and extract information from VCF files is <code>bcftools</code>, part of the SAMtools suite.</p>

    <div class="accordion mb-4" id="vcfToolsAccordion">

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading1">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">
            1. View VCF File Header
          </button>
        </h2>
        <div id="collapse1" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools view -h variants.vcf.gz</code></pre>
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading2">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">
            2. Extract Variant Statistics
          </button>
        </h2>
        <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools stats variants.vcf.gz > vcf.stats
plot-vcfstats vcf.stats -p plots/</code></pre>
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading3">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">
            3. Filter by Variant Quality
          </button>
        </h2>
        <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools filter -i 'QUAL>30' variants.vcf.gz -Oz -o filtered.vcf.gz</code></pre>
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading4">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4">
            4. Extract Region of Interest
          </button>
        </h2>
        <div id="collapse4" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools view -r chr1:1000000-2000000 variants.vcf.gz -Oz -o chr1_region.vcf.gz</code></pre>
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading5">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5">
            5. Extract Specific Samples
          </button>
        </h2>
        <div id="collapse5" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools view -s Sample1,Sample2 variants.vcf.gz -Oz -o subset_samples.vcf.gz</code></pre>
          </div>
        </div>
      </div>

      <div class="accordion-item">
        <h2 class="accordion-header" id="heading6">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6">
            6. Convert to Table
          </button>
        </h2>
        <div id="collapse6" class="accordion-collapse collapse" data-bs-parent="#vcfToolsAccordion">
          <div class="accordion-body">
            <pre><code>bcftools query -f '%CHROM\t%POS\t%REF\t%ALT\t%DP\t%AF\n' variants.vcf.gz > variants.tsv</code></pre>
          </div>
        </div>
      </div>

    </div>
    <p>This guide helps you explore and manipulate VCF files efficiently using <code>bcftools</code>.</p>
    <p><a href="../blog.html">‚Üê Back to Blog</a></p>
  </div>
</section>
